var famax_global_options={};!function(a){var e=function(){var e,t,i;for(a("#famax").append('<div id="famax-header"><div id="famax-stat-holder"></div></div>'),e="",t=100/famax_global_options.famaxColumns,i=1;i<=famax_global_options.famaxColumns;i++)e+='<div id="famax-video-list-div'+i+'" style="width:'+t+'%;" class="famax-video-list-div"></div>';a("#famax").append('<div id="famax-encloser">'+e+'<div class="load-more-wrapper"><span class="load-more" id="load-more"> Load More..</span></div></div>'),a("#load-more").click(function(){a("#load-more").text("loading.."),s()}),a("#famax").append('<div id="famax-lightbox"><div id="picasa-lightbox-wrapper"><div id="picasa-lightbox-image"><img id="picasa-img-lightbox" src=""><iframe id="famax-video-lightbox" width="640" height="360" src="" frameborder="0" allowfullscreen></iframe></div><div id="picasa-lightbox-helper"></div></div></div>'),a("#famax-lightbox").click(function(){a("#picasa-img-lightbox").attr("src",""),a("#famax-video-lightbox").attr("src",""),a("#famax-lightbox").hide(),a("#famax-img-lightbox").hide(),a("#famax-video-lightbox").hide()}),a("#famax-lightbox").hide(),a("#famax-img-lightbox").hide(),a("#famax-video-lightbox").hide()},t=function(){var a,t,o=famax_global_options.facebookPageUrl.substring(famax_global_options.facebookPageUrl.lastIndexOf("/")+1);e(),a=l(o),famax_global_options.famaxPageId=a,t="https://graph.facebook.com/v2.2/"+a+"/posts?limit="+famax_global_options.famaxResultCount+"&access_token="+famax_global_options.fbAccessToken+"&fields=id,type,message,object_id,picture,name,description,link,from,updated_time,created_time,attachments",i(t)},i=function(e){fqlPending=1,a.ajax({url:e,type:"GET",async:!0,cache:!0,dataType:"jsonp",success:function(a){o(a)},error:function(a){alert(a)},beforeSend:d})},o=function(e){var t,i,o,l,d,s,r,c,f,m,h,p,g,x,_,b,u;for(console.log(e),famax_global_options.nextPageURL=e.paging.next,t=e.data,m=[],b=0;b<t.length;b++){if(i=t[b].id,o=t[b].from.id,l=t[b].message,d=t[b].description,r="https://graph.facebook.com/"+o+"/picture",c=t[b].attachments,f=null,null!=c&&(f=c.data),created_time=t[b].created_time,(null==l||""==l)&&(l=t[b].name,null==l&&(l="")),null!=f&&""!=f&&"undefined"!=f)for(u=0;u<f.length;u++)p=f[u].type,g=f[u].media,null!=g&&(g=g.image.src),x=f[u].target,null!=x&&(x=x.url),null!=p?"video"==p||("photo"==p?(width=0,height=0):(width=0,height=0)):x=null,h={type:p,src:g,href:x,height:height,width:width},m.push(h);else m=null,p=null,g=null,x=null;_={post_id:i,actor_id:o,actor_pic_src:r,message:l,description:d,actor_name:s,fbAttachmentList:m,created_time:created_time},n(_),m=[]}fqlPending=0,famaxLastCreatedTime=created_time,a("#load-more").text("Load More..")},n=function(e){var t,i,o,n,l,d,s,c,f,m=e.fbAttachmentList,h="",p=e.message;if(null!=p&&""!=p&&"undefined"!=p)if(d="",s=p.length,-1!=p.indexOf("http://")){for(o=p.indexOf("http://"),n=p.charAt(o-1),l=o;p.charAt(l)!=n&&(d+=p.charAt(l++),!(" "==p.charAt(l)||l>=s||"\n"==p.charAt(l)||"\r\n"==p.charAt(l))););p=p.replace(d,'<a target="_blank" href="'+d+'">'+d+"</a>")}else if(-1!=p.indexOf("https://")){for(o=p.indexOf("https://"),n=p.charAt(o-1),l=o;p.charAt(l)!=n&&(d+=p.charAt(l++),!(" "==p.charAt(l)||l>=s||"\n"==p.charAt(l)||"\r\n"==p.charAt(l))););p=p.replace(d,'<a target="_blank" href="'+d+'">'+d+"</a>")}else if(-1!=p.indexOf("www.")){for(o=p.indexOf("www."),n=p.charAt(o-1),l=o;p.charAt(l)!=n&&(d+=p.charAt(l++),!(" "==p.charAt(l)||l>=s||"\n"==p.charAt(l)||"\r\n"==p.charAt(l))););p=p.replace(d,'<a target="_blank" href="'+d+'">'+d+"</a>")}if(null!=m&&""!=m&&"undefined"!=m)for(c=0;c<m.length;c++)attachment_type=m[c].type,t=m[c].src,attachment_href=m[c].href,0==c?i=-1!=attachment_type.indexOf("photo")?'<div class="famax-pic-tnail" data-picSrc="'+t+'" style="width:100%;text-align:center;"><a target="_blank" href="'+attachment_href+'"><img class="video-img"  id="'+e.post_id+'" src="'+t+'"></a></div>':-1!=attachment_type.indexOf("link")||-1!=attachment_type.indexOf("share")?'<div class="famax-link-tnail" style="width:100%;text-align:center;"><a target="_blank" href="'+attachment_href+'"><i class="_1y4" style="background: url(\'./images/famax_link.png\') no-repeat 0 0;"></i><img  class="link-img" id="'+e.post_id+'" src="'+t+'"></a></div>':-1!=attachment_type.indexOf("video")?'<div class="famax-video-tnail" data-videoSrc="'+attachment_href+'" style="width:100%;text-align:center;"><a target="_blank" href="'+attachment_href+'"><i class="_1y4" style="background: url(\'./images/famax_video.png\') no-repeat 0 0;"></i><img class="video-img"  id="'+e.post_id+'" src="'+t+'"></a></div>':'<div class="famax-pic-tnail" data-picSrc="'+t+'" style="width:100%;text-align:center;"><a target="_blank" href="'+attachment_href+'"><img class="video-img"  id="'+e.post_id+'" src="'+t+'"></a></div>':c>0&&-1!=attachment_type.indexOf("photo")&&(h+='<div class="famax-playlist-sidebar-video" data-picSrc="'+t+'" style="background-image:url(\''+t+"')\"></div>");else i="",h="";f=r(),null!=h&&"undefined"!=h&&""!=h&&(h='<div class="famax-pic-train" id="famax-pic-train-'+e.post_id+'">'+h+"</div>"),a("#famax-video-list-div"+f).append('<div class="famax-video-tnail-box">'+i+h+'<span class="famax-video-list-title">'+p+"</span><br/></div>")},l=function(e){var t,i="https://graph.facebook.com/"+e+"?access_token="+famax_global_options.fbAccessToken;return a.ajax({type:"GET",url:i,async:!1,beforeSend:function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/j-son;charset=UTF-8")},dataType:"json",success:function(a){t=a.id,c(a)}}),t},d=function(a){a&&a.overrideMimeType&&a.overrideMimeType("application/j-son;charset=UTF-8")},s=function(){fqlPending||null==famax_global_options.nextPageURL||i(famax_global_options.nextPageURL)},r=function(){var e,t=a("#famax-video-list-div1").height(),i=0,o=1;for(e=1;e<=famax_global_options.famaxColumns;e++)i=a("#famax-video-list-div"+e).height(),t>i&&(t=i,o=e);return o},c=function(e){var t=e.name,i="https://graph.facebook.com/"+e.id+"/picture",o=(e.likes,e.talking_about_count,e.link);a("#famax-header").append('<a target="_blank" href="'+o+'"><img style="vertical-align:middle; height:60px; margin:15px; display:inline-block;" src="'+i+'"/>'+t+"</a>&nbsp;&nbsp;&nbsp;"),a("#famax-header").append('<div class="famax-like-wrapper"><iframe src="http://www.facebook.com/plugins/like.php?href=http%3A%2F%2Fwww.facebook.com%2F'+famax_global_options.famaxPageId+'&amp;send=false&amp;layout=box_count&amp;width=200&amp;show_faces=false&amp;font&amp;colorscheme=light&amp;action=like&amp;height=90&amp;appId=384323531651193" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:70px;" allowTransparency="true"></iframe></div>')};a.fn.famax=function(a){famax_global_options.facebookPageUrl=a.facebookPageUrl,famax_global_options.fbAccessToken=a.fbAccessToken,famax_global_options.famaxWidgetWidth=a.famaxWidgetWidth,famax_global_options.famaxWidgetHeight=a.famaxWidgetHeight,famax_global_options.famaxColumns=a.famaxColumns||2,famax_global_options.famaxResultCount=a.famaxResultCount||10;var e=this;return null!=famax_global_options.famaxWidgetWidth&&e.css("width",famax_global_options.famaxWidgetWidth),null!=famax_global_options.famaxWidgetHeight&&e.css("height",famax_global_options.famaxWidgetHeight),null==famax_global_options.fbAccessToken?void alert("No Access Token Received"):null==famax_global_options.facebookPageUrl?void alert("No FanPage found"):(t(),this)}}(jQuery);
